**University** : [ITMO University](https://itmo.ru/ru/)

**Faculty** : [FICT](https://fict.itmo.ru)

**Course** : [Cloud platforms as the basis of technology entrepreneurship](https://itmo-ict-faculty.github.io/cloud-platforms-as-the-basis-of-technology-entrepreneurship/)

**Year**: 2024/2025

**Group** : U4225

**Author** : Semykina Vera Stanislavovna

**Lab**: Lab3

**Date of create**: 09.11.2024

**Date of finished** : 09.11.2024

# Лабораторная работа №4: "Разработка инфраструктуры MVP AI приложения."

## Цель работы:
Создать прототип AI-приложения с базовой функциональностью.

# Ход работы:

## 1. Описание проекта
### Подбор музыки по настроению
Приложение, которое подбирает музыку или плейлисты в зависимости от настроения пользователя, основываясь на анализе текстов и введенной информации.

#### Начальное состояние:
пользователь выбирает настроение (например, спокойствие, энергичность, грусть), и приложение предлагает простой плейлист из предварительно заданных песен.
#### Тестирование с партнёрами: 
добавление функциональности для анализа загружаемых песен и настройки рекомендаций по предпочтениям пользователя.
#### Продовое решение: 
подключение к потоковым сервисам, персонализированные плейлисты, возможность сохранения плейлистов и добавление новых настроений.

## 2. Логика приложения
Базовый функционал приложения включает в себя следующие основные компоненты:
1. Выбор и анализ настроения.
2. Подбор музыки на основе заданных метаданных треков.
3. Воспроизведение музыки через встроенный плеер.
4. Оценка треков (лайки/дизлайки) для будущей персонализации.
5. Уведомления и простая аналитика по предпочтениям пользователя.

### 1. **Выбор настроения**
   - **Интерфейс для выбора настроения**: Пользователь может выбрать свое текущее настроение из заранее заданного списка (например, спокойствие, счастье, грусть, мотивация) или может ввести свое описание настроения.
   - **Анализ настроения**: Если пользователь вводит текстовое описание, приложение использует NLP (обработку естественного языка) для распознавания ключевых слов и анализа, чтобы определить основное настроение.

### 2. **Подбор музыки на основе настроения**
   - **Каталог музыки**: Приложение включает в себя базу данных с треками, которые предварительно распределены по категориям настроения. Каждый трек имеет метаданные (жанр, темп, настроение), что позволяет находить соответствующие композиции.
   - **Рекомендация плейлиста**: На основе выбранного настроения приложение генерирует плейлист из соответствующих треков, которые пользователи могут воспроизвести внутри приложения.

### 3. **Прослушивание музыки**
   - **Встроенный аудиоплеер**: Приложение предоставляет базовый аудиоплеер для воспроизведения треков из плейлиста. Пользователь может приостановить, возобновить или переключить трек.
   - **Интеграция с музыкальными платформами** (опционально): Для более продвинутой версии можно предусмотреть интеграцию с популярными музыкальными платформами (например, Spotify), что позволит пользователю прослушивать полные версии треков и сохранять плейлисты.

### 4. **Оценка рекомендаций**
   - **Система лайков и дизлайков**: Пользователь может оценить трек с помощью лайка или дизлайка. Лайки добавляют трек в избранное, а дизлайки сигнализируют приложению, что пользователь предпочитает не слушать этот трек.
   - **Обучение на основе предпочтений**: Приложение запоминает, какие треки пользователю нравятся, и учитывает это для подбора музыки в будущем. На базе оценок приложение постепенно обучается лучше подбирать композиции.

### 5. **Уведомления и напоминания**
   - **Уведомления о новых подборках**: Приложение может отправлять уведомления с новыми подборками музыки для текущего настроения пользователя.
   - **Ежедневные рекомендации**: По желанию пользователя можно настроить ежедневные уведомления с предложением плейлистов на основе его активности и привычек.

### 6. **Простая аналитика прослушиваний**
   - **История прослушиваний**: Приложение сохраняет историю прослушиваний, чтобы пользователь мог вернуться к понравившимся плейлистам.
   - **Отчеты по настроению**: Отчеты показывают, какие настроения пользователь выбирал чаще всего и какая музыка поднимала ему настроение, что может быть полезно для создания более точных рекомендаций.

## 3. Схема инфраструктуры приложения
![MoodMusic_Infrastructure](https://github.com/user-attachments/assets/338b02f9-18a1-4117-ac2b-334c85f8a621)

### Логика работы приложения в соответствии с приведенной схемой заключается в следующем:
Вот подробная логика работы приложения на основе предоставленной схемы инфраструктуры:

1. **Интерфейс пользователя (Frontend Приложение)**:
   - Интерфейс пользователя позволяет взаимодействовать с приложением через выбор настроения, прослушивание предложенной музыки и оценку треков (лайк/дизлайк).
   - Пользователь начинает с выбора своего текущего настроения из заранее заданного списка (например, спокойствие, счастье, грусть) или вводит своё описание настроения.
   - Интерфейс отправляет запросы пользователя (выбор настроения и обратная связь) в backend через **API Gateway**.

2. **API Gateway**:
   - **API Gateway** выступает в качестве центрального узла для обработки запросов пользователя. Он получает запросы от интерфейса и перенаправляет их в нужные backend-сервисы.
   - API Gateway подключен к нескольким backend-сервисам, включая **NLP Service**, **Recommendation Engine**, **Notification Service** и другим компонентам.
   - Gateway обеспечивает безопасное и эффективное взаимодействие между фронтендом и бекендом, выполняя задачи аутентификации, контроля скорости запросов и управления трафиком.

3. **Сервис NLP (Обработка текста)**:
   - Когда пользователь вводит текстовое описание своего настроения, **API Gateway** перенаправляет этот текст в **NLP Service**.
   - Сервис NLP, используя, например, Yandex SpeechKit или SberCloud SmartSpeech, анализирует текст и определяет ключевые индикаторы настроения.
   - После анализа NLP-сервис возвращает определённое настроение (например, «радость», «спокойствие»), и API Gateway отправляет его в Recommendation Engine для генерации подходящего плейлиста.

4. **Рекомендательный движок (Recommendation Engine)**:
   - **Recommendation Engine** — это основной компонент для создания музыкальных плейлистов, основанных на предпочтениях и настроении пользователя.
   - Он использует информацию о настроении (полученную от NLP анализа или из прямого выбора пользователя), чтобы сделать запрос к **базе данных** и получить треки, соответствующие настроению и предпочтениям пользователя.
   - Рекомендательный движок обращается к **хранилищу музыкального контента** для доступа к музыкальным файлам. Для расширенного контента он может также взаимодействовать с **внешним музыкальным API** (например, VK Music API) для получения большего количества треков.
   - Компонент также обновляет базу данных обратной связью от пользователя (лайк/дизлайк) для персонализации следующих рекомендаций, улучшая рекомендации с течением времени.

5. **База данных (Данные пользователей и метаданные музыки)**:
   - **База данных** хранит информацию о пользователях, их предпочтениях и метаданные музыкальных треков (например, жанр, настроение, темп).
   - Это хранилище данных позволяет Recommendation Engine подбирать персонализированные музыкальные рекомендации на основе истории взаимодействия каждого пользователя.
   - База данных также подключена к **Сервису аналитики**, который собирает информацию о трендах и популярности рекомендаций.

6. **Хранилище музыкального контента**:
   - Это хранилище содержит либо сами аудиофайлы, либо ссылки на музыкальный контент.
   - Такие сервисы, как Yandex Object Storage или VK Cloud Object Storage, могут использоваться для безопасного хранения аудиофайлов или ссылок.
   - Recommendation Engine использует это хранилище для загрузки музыкальных треков для пользователя и интегрируется с внешним музыкальным API для получения дополнительных опций.

7. **Сервис аналитики**:
   - **Сервис аналитики** предоставляет важные данные о предпочтениях пользователей, популярности треков и пользовательских трендах.
   - Он подключен как к базе данных, так и к API Gateway и отслеживает метрики, такие как популярные настроения, самые прослушиваемые треки и вовлеченность пользователей.
   - Аналитические данные помогают улучшать рекомендации и настраивать другие сервисы на основе поведения пользователей.

8. **Внешний музыкальный API (например, VK Music API)**:
   - Внешний музыкальный API служит дополнительным источником музыкального контента, помимо того, что хранится в Music Content Storage.
   - Когда Recommendation Engine требуется получить новые треки или предложить пользователям расширенный выбор, он обращается к VK Music API или аналогичным платформам для получения соответствующего контента.
   - Такая интеграция позволяет расширить возможности приложения без необходимости хранить обширную музыкальную библиотеку локально.

9. **Сервис уведомлений**:
   - **Сервис уведомлений** отправляет персонализированные оповещения пользователям, такие как уведомления о новых плейлистах или ежедневные рекомендации на основе часто выбираемого настроения.
   - Можно использовать VK Cloud Messaging или SberCloud Messaging для отправки уведомлений.
   - Этот сервис подключен к API Gateway, который перенаправляет оповещения пользователю в зависимости от его активности или новых рекомендаций от Recommendation Engine.

## 3. Сервисы и компаненты
Оновное ограничительное условия для выбора сервисов стала география располодения разработчиков и георгафический рынок использования прилодения. Налоим условия, чт ои разработчики и  рынок российские. 

### 1. **User Interface (Frontend App)**

   - **Описание**: Интерфейс взаимодействия с пользователем, предоставляющий функции выбора настроения, воспроизведения музыки и оценок треков.
   - **Инструменты для разработки**: 
     - **React, Vue.js или Angular** — популярные библиотеки и фреймворки для создания интерфейсов.
     - **WebSocket или REST API** — для взаимодействия с backend через API Gateway.
     - **VK Mini Apps** — если приложение интегрируется с экосистемой VK, это упрощает разработку под VK ID и предоставляет доступ к VK API.

### 2. **API Gateway**

   - **Описание**: Центральный компонент, обрабатывающий запросы от интерфейса и направляющий их к соответствующим сервисам (NLP, Recommendation Engine, Notification и др.).
   - **Примеры**:
     - **Nginx или Traefik** — open-source решения для API Gateway, которые можно развернуть на российских серверах.
     - **Yandex API Gateway** — сервис Яндекса для управления API, подходит для интеграции с другими сервисами Яндекса.
     - **Kong** (self-hosted) — API Gateway с расширенными возможностями, можно развернуть локально.

### 3. **NLP Service (Обработка текста)**

   - **Описание**: Анализ текста для определения настроения пользователя по введённому описанию.
   - **Примеры**:
     - **Yandex SpeechKit** — предоставляет возможности NLP и распознавания текста для анализа настроения.
     - **SberCloud SmartSpeech** — сервис от Сбера с NLP и синтезом речи, хорошо подходит для российских разработчиков.
     - **MTS AI** — NLP-сервисы от МТС с поддержкой анализа текста и распознавания настроения.

### 4. **Recommendation Engine (Рекомендательный движок)**
   - **Описание**: Компонент, который подбирает музыку на основе предпочтений и настроения пользователя.
   - **Примеры**:
     - **VK Cloud Solutions или Yandex DataSphere** — инфраструктуры для создания и обучения рекомендательных моделей в российских дата-центрах.
     - **Собственная разработка** — рекомендательные алгоритмы, разработанные на базе Python (например, с использованием библиотек scikit-learn или TensorFlow), размещенные на российских серверах для полного контроля.

### 5. **База данных (Данные пользователей и метаданные музыки)**
   - **Описание**: Хранит данные о пользователях, их предпочтениях и метаданные музыкальных треков.
   - **Примеры**:
     - **Yandex Managed Databases** — управляемые базы данных (PostgreSQL, MongoDB) от Яндекса.
     - **VK Cloud Databases** — поддержка различных баз данных, включая PostgreSQL и MySQL.
     - **ClickHouse** — аналитическая база данных от Яндекса, идеально подходит для высокопроизводительной обработки данных.

### 6. **Music Content Storage (Хранилище музыкальных файлов)**
   - **Описание**: Хранилище аудиофайлов или ссылок на музыкальный контент.
   - **Рекомендации**:
     - **Yandex Object Storage** — сервис для хранения больших объемов данных, таких как аудиофайлы.
     - **VK Cloud Object Storage** — аналогичное решение для хранения и доступа к музыкальному контенту.
     - **MinIO** (self-hosted) — объектное хранилище с поддержкой S3, которое можно развернуть локально.

### 7. **Analytics Service (Сервис аналитики)**

   - **Описание**: Сервис для сбора аналитических данных о предпочтениях пользователей, прослушиваемых треках и общей статистики.
   - **Рекомендации**:
     - **Yandex Metrica** — мощный инструмент для сбора данных о пользователях и аналитики, поддерживающий отслеживание поведения пользователей.
     - **VK Cloud Solutions Analytics** — для детальной аналитики и отслеживания трендов в данных.
     - **Matomo (self-hosted)** — open-source система аналитики, которую можно развернуть на собственных серверах.

### 8. **External Music API (Внешний музыкальный API)**
   - **Описание**: API для доступа к большему количеству музыкального контента.
   - **Рекомендации**:
     - **VK Music API** — при доступе к VK экосистеме можно использовать VK Music для интеграции музыки.
     - **Яндекс.Музыка API** — ограниченный доступ, требует согласования, но может стать источником контента.

### 9. **Notification Service (Сервис уведомлений)**

   - **Описание**: Сервис для отправки push-уведомлений пользователям, таких как рекомендации плейлистов.
   - **Рекомендации**:
     - **VK Cloud Messaging** — для отправки push-уведомлений пользователям на российском рынке.
     - **SberCloud Messaging** — альтернатива от Сбера для уведомлений.
     - **Firebase Cloud Messaging** (ограниченно) — если приложение поддерживается на устройствах пользователей в России.

### Итоговая инфраструктура для российского рынка

- **Frontend**: React/Vue.js/Angular для пользовательского интерфейса, WebSocket для взаимодействия.
- **Backend и API Gateway**: Nginx или Yandex API Gateway для маршрутизации и контроля.
- **NLP**: Yandex SpeechKit или SberCloud SmartSpeech для обработки текстов.
- **Recommendation Engine**: Собственный алгоритм или Yandex DataSphere для рекомендаций.
- **Database**: Yandex Managed Databases или ClickHouse для хранения данных.
- **Music Storage**: Yandex Object Storage или VK Cloud Storage для хранения контента.
- **Analytics**: Yandex Metrica или Matomo для анализа данных.
- **Notification Service**: VK Cloud Messaging или SberCloud Messaging для уведомлений.
